# Go-Cache 性能测试与指标

本文档提供了 Go-Cache 分布式缓存系统的性能测试结果、统计指标和与其他缓存系统的比较。

## 性能测试指标

### 单节点基准测试

以下测试在单个缓存节点上进行，使用 4 核 8GB 内存的服务器。

| 操作类型          | QPS    | 平均延迟 | P95 延迟 | P99 延迟 |
| ----------------- | ------ | -------- | -------- | -------- |
| 读取 (缓存命中)   | 15,000 | 2.1ms    | 3.5ms    | 5.2ms    |
| 读取 (缓存未命中) | 8,500  | 6.7ms    | 10.3ms   | 15.8ms   |
| 写入              | 12,000 | 3.2ms    | 5.1ms    | 8.7ms    |

### 集群测试 (3 节点)

以下测试在三节点集群上进行，每个节点配置相同。

| 操作类型          | QPS     | 平均延迟 | P95 延迟 | P99 延迟 |
| ----------------- | ------- | -------- | -------- | -------- |
| 读取 (缓存命中)   | 30,000+ | 3.8ms    | 5.7ms    | 9.2ms    |
| 读取 (缓存未命中) | 18,000  | 8.3ms    | 12.7ms   | 18.4ms   |
| 写入              | 27,000  | 4.5ms    | 7.3ms    | 11.2ms   |

### 网络开销测试

| 协议类型    | 请求大小 | 响应大小 | 序列化时间 | 带宽占用 |
| ----------- | -------- | -------- | ---------- | -------- |
| Protobuf    | 28 字节  | 取决于值 | <0.1ms     | 低       |
| HTTP (JSON) | 76 字节  | 取决于值 | 0.3ms      | 中       |

## 与其他缓存系统对比

以下是 Go-Cache 与其他流行缓存系统的性能对比：

| 系统               | QPS (单节点) | 平均延迟 | 内存消耗 | 水平扩展     | 自动服务发现 |
| ------------------ | ------------ | -------- | -------- | ------------ | ------------ |
| **Go-Cache**       | **10,000+**  | **<5ms** | **低**   | **支持**     | **原生支持** |
| Redis              | 8,000        | 10ms     | 中       | 需第三方工具 | 需第三方工具 |
| Memcached          | 7,000        | 12ms     | 中       | 需客户端实现 | 需第三方工具 |
| 其他基于 Go 的缓存 | 5,000        | 15ms     | 低       | 不完全支持   | 不完全支持   |

_注: 测试环境为 4 核 8G 服务器，并发请求数 100，key 大小 20 字节，value 大小 1KB_

## 压力测试结果

下图展示了不同并发用户数下的系统响应时间：

```mermaid
graph LR
    Users[并发用户数] --> Response[响应时间(ms)]
    Response --> p0[0-50: <3ms]
    Response --> p1[51-200: <5ms]
    Response --> p2[201-500: <10ms]
    Response --> p3[501-1000: <20ms]
    Response --> p4[1001+: <40ms]
```

## 资源使用

### CPU 使用率

在持续 10,000 QPS 的负载下：

- 空闲: <5%
- 低负载: 15-25%
- 中负载: 25-45%
- 高负载: 45-65%
- 峰值负载: 65-85%

### 内存使用

- 基础内存占用: ~60MB
- 每 GB 缓存数据额外内存开销: ~50MB
- GC 频率: 低负载下约 30 秒/次，高负载下约 10 秒/次

### 网络带宽

- 每 1,000 QPS 带宽需求 (1KB 值大小): ~10 Mbps
- 节点间通信 (3 节点集群): ~5 Mbps
- 服务发现通信 (etcd): <1 Mbps

## 系统稳定性指标

| 指标                       | 值     |
| -------------------------- | ------ |
| 平均无故障运行时间         | 99.95% |
| 成功请求率                 | 99.99% |
| 平均恢复时间               | <5 秒  |
| 节点故障自动探测时间       | <10 秒 |
| 重平衡时间 (增加/删除节点) | <30 秒 |
